---
deployment:
  tasks:
    - export DEPLOYPATH=/home/<username>/public_html  # üëâ ƒê∆∞·ªùng d·∫´n public_html ho·∫∑c th∆∞ m·ª•c domain con

    # X√≥a cache c≈© (n·∫øu c√≥)
    - /bin/rm -rf $DEPLOYPATH/bootstrap/cache/*
    - /bin/rm -rf $DEPLOYPATH/storage/framework/cache/*

    # C√†i ƒë·∫∑t composer dependencies
    - /usr/local/bin/composer install --no-dev --optimize-autoloader --working-dir=$DEPLOYPATH

    # Copy environment file n·∫øu b·∫°n gi·ªØ .env ngo√†i repo
    # (b·ªè comment n·∫øu b·∫°n c·∫ßn)
    # - /bin/cp /home/<username>/.env $DEPLOYPATH/.env

    # Ch·∫°y migrate database (n·∫øu cho ph√©p)
    # ‚ö†Ô∏è C·∫©n tr·ªçng khi auto migrate tr√™n production
    # - /usr/local/bin/php $DEPLOYPATH/artisan migrate --force

    # Cache l·∫°i c·∫•u h√¨nh, route
    - /usr/local/bin/php $DEPLOYPATH/artisan config:cache
    - /usr/local/bin/php $DEPLOYPATH/artisan route:cache
    - /usr/local/bin/php $DEPLOYPATH/artisan view:clear

    # Ph√¢n quy·ªÅn th∆∞ m·ª•c storage & bootstrap/cache
    - /bin/chmod -R 775 $DEPLOYPATH/storage
    - /bin/chmod -R 775 $DEPLOYPATH/bootstrap/cache
